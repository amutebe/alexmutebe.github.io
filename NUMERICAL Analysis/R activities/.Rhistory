mode_age =  mfv(HSE_2011$Age)
mode_bmi =  mfv(HSE_2011$bmival)
print(mode_house_size)
print(mode_age)
print(mode_bmi)
calculate_mode <- function(data) {
uniq_vals <- unique(data)
uniq_counts <- table(data)
mode_value <- uniq_vals[which.max(uniq_counts)]
return(mode_value)
}
# Calculate the mode using the user-defined function
mode_house_size <- calculate_mode(HSE_2011$HHSize)
mode_age <- calculate_mode(HSE_2011$Age)
mode_bmi <- HSE_2011 %>% filter(bmival > 0)
mode_bmi <- calculate_mode(mode_bmi$Age)
# Print the mode
print(mode_house_size)
print(mode_age)
print(mode_bmi)
print(mode_bmi)
#Create a subset with drinking information#Checking for data type dnow
drink <- HSE_2011 %>% select(Sex,dnnow)
#Checking for data type dnow
str(drink$dnnow)
# Get Counts for of whether drink by gender
xtabs(~ dnnow + Sex, data = drink)
# calculating percentages of alcohol status by gender
drink_percent <- na.omit(drink) %>%
group_by(Sex,dnnow) %>%
summarise(Percentage = n() / nrow(na.omit(drink)) * 100)
drink_percent
# We use Chi-square test since both sex and dnnow are categorical variables
response <- c('Yes','No')
male_counts <- c(3172, 605)
female_counts <- c(3540,1217)
#Creating a merged table
drink_status <- rbind(male_counts,female_counts)
#Performing a chi-square test
chisq.test(drink_status)
#Create a subset with drinking information
drink_region <- HSE_2011 %>% select(Origin,dnnow)
#Checking for data type Origin
str(drink_region$Origin)
val_labels(drink_region$Origin)
# Get Counts for of whether drink by gender
xtabs(~ dnnow + Origin, data = drink_region)
# calculating percentages of alcohol status by origin
drink_region_percent <- na.omit(drink_region) %>%
group_by(Origin,dnnow) %>%
summarise(Percentage = n() / nrow(na.omit(drink_region)) * 100)
drink_region_percent
# We use Chi-square test since both sex and dnnow are categorical variables
response <- c('Yes','No')
white <- c(5925,1219)
w_irish <- c(62,15)
w_traveller <- c(2,1)
w_bg <- c(326,88)
w_caribean <- c(23,3)
w_ba <- c(8,2)
w_asian <- c(17,13)
mixed_bg <- c(18,13)
indian <- c(100,105)
pakistani <- c(6,134)
bangladesh <- c(5,41)
chinese <- c(26,8)
asian_bg <- c(52,45)
african <- c(46,72)
caribean <- c(53,25)
black_bg <- c(18,4)
arab <- c(4,7)
other <- c(11,15)
#Creating a merged table
region_drink_status <- rbind(white,w_irish,w_traveller,w_bg,w_caribean,w_ba,w_asian,mixed_bg,indian,pakistani,bangladesh,chinese,asian_bg,african,caribean,black_bg,arab,other)
#Performing a chi-square test
chisq.test(region_drink_status, simulate.p.value=TRUE)
bar_plot <- ggplot(data, aes(x = totalwu, y = Origin, color = Origin)) +
geom_jitter(na.rm = TRUE) +  # Add jittered points to avoid overlap
labs(title = "Scatter Plot of Alcohol consumption by region",
x = "Alcohol consumption by region",
y = "") +
theme_minimal()  # Apply minimal them
print(cor_age_gender)
bar_plot <- ggplot(data, aes(x = totalwu, y = Origin, color = Origin)) +
geom_jitter(na.rm = TRUE) +  # Add jittered points to avoid overlap
labs(title = "Scatter Plot of Alcohol consumption by region",
x = "Alcohol consumption by region",
y = "") +
theme_minimal()  # Apply minimal them
bar_plot <- ggplot(HSE_2011, aes(x = totalwu, y = Origin, color = Origin)) +
geom_jitter(na.rm = TRUE) +  # Add jittered points to avoid overlap
labs(title = "Scatter Plot of Alcohol consumption by region",
x = "Alcohol consumption by region",
y = "") +
theme_minimal()  # Apply minimal them
bar_plot
var_label(HSE_2011)
#create subset with sex, height and weight
height_weight <- HSE_2011 %>% select(Sex,htval,wtval)
#Create separate datasets for each sex category
males_data <- height_weight %>% filter(Sex==1)
females_data <- height_weight %>% filter(Sex==2)
# Using histogram ot check distribution in the height for Males
hist(males_data$htval,
col="green",
border="black",
prob = TRUE,
xlab = "Valid Height",
main = "Distribution in the Valid Height for Males")
lines(density(males_data$htval,na.rm = TRUE),
lwd = 2,
col = "chocolate3")
# Using histogram ot check distribution in the height for Females
hist(females_data$htval,
col="green",
border="black",
prob = TRUE,
xlab = "Valid Height",
main = "Distribution in the Valid Height for Females")
lines(density(females_data$htval,na.rm = TRUE),
lwd = 2,
col = "chocolate3")
# QQplot of normally distributed values in the male group
qqnorm(males_data$htval)
# Add qqline to plot
qqline(males_data$htval, col = "darkgreen")
shapiro.test(males_data$htval)
# the Shapiro-Wilk normality test p-value is 2.2e-16, which is less than 0.05 means does not follow a normal distribution therefore we shall use wilcoxin rank sum/man whitney u test
# QQplot of normally distributed height values for the female group
qqnorm(females_data$htval)
# Add qqline to plot
qqline(females_data$htval, col = "darkgreen")
wilcox_test_result <- wilcox.test(htval ~ Sex, data = height_weight)
wilcox_test_result
# Using histogram ot check distribution in the Weight for Males
hist(males_data$wtval,
col="green",
border="black",
prob = TRUE,
xlab = "Valid Weight",
main = "Distribution in the Valid Weight for Males")
lines(density(males_data$wtval,na.rm = TRUE),
lwd = 2,
col = "chocolate3")
# Using histogram ot check distribution in the Weight for Females
hist(females_data$wtval,
col="green",
border="black",
prob = TRUE,
xlab = "Valid Weight",
main = "Distribution in the Valid Weight for Females")
lines(density(females_data$wtval,na.rm = TRUE),
lwd = 2,
col = "chocolate3")
# QQplot of normally distributed values in the male group
qqnorm(males_data$wtval)
# Add qqline to plot
qqline(males_data$wtval, col = "darkgreen")
# QQplot of normally distributed Weight values for the female group
qqnorm(females_data$wtval)
# Add qqline to plot
qqline(females_data$wtval, col = "darkgreen")
shapiro.test(males_data$wtval)
# the Shapiro-Wilk normality test p-value is 2.2e-16, which is less than 0.05 means does not follow a normal distribution therefore we shall use wilcoxin rank sum/man whitney u test
wilcox_test_result <- wilcox.test(wtval ~ Sex, data = height_weight)
wilcox_test_result
# use the Pearson correlation coefficient for continuous variables i.e we use cor() to calculates the correlation matrix for the continuous variables income, and age.
# Test for normal distribution of Age, and Income
shapiro.test(HSE_2011$Age[0:5000])
shapiro.test(HSE_2011$eqvinc[0:5000])
# the Shapiro-Wilk normality test p-value is 2.2e-16, which is less than 0.05 means data does not follow a normal distribution therefore we shall use spearman's correlation test
cor_age_income = cor.test(HSE_2011$Age, HSE_2011$eqvinc, method = "spearman",exact = FALSE)
print(cor_age_income)
cor_drink_income = cor.test(HSE_2011$dnnow, HSE_2011$eqvinc)
print(cor_drink_income)
cor_drink_age = cor.test(HSE_2011$dnnow, HSE_2011$Age)
print(cor_drink_age)
cor_drink_gender = cor.test(HSE_2011$dnnow, HSE_2011$Sex)
print(cor_drink_gender)
cor_income_drink = cor.test(HSE_2011$eqvinc, HSE_2011$dnnow)
print(cor_income_drink)
cor_income_age = cor.test(HSE_2011$eqvinc, HSE_2011$Age)
print(cor_income_age)
cor_income_gender = cor.test(HSE_2011$eqvinc, HSE_2011$Sex)
print(cor_income_gender)
cor_age_drink = cor.test(HSE_2011$Age, HSE_2011$dnnow)
print(cor_age_drink)
cor_age_gender = cor.test(HSE_2011$Age, HSE_2011$Sex)
print(cor_age_gender)
plot(HSE_2011$dnnow,HSE_2011$Sex)
mosaicplot(HSE_2011$dnnow,HSE_2011$Sex)
mosaicplot(table(HSE_2011$dnnow,HSE_2011$Sex))
mosaicplot(table(HSE_2011$dnnow,HSE_2011$Sex))
mosaicplot(table(HSE_2011$dnnow,HSE_2011$Sex))
mosaicplot(table(HSE_2011$dnnow,HSE_2011$Sex))
cor_drink_gender = cor.test(HSE_2011$dnnow, HSE_2011$Sex)
print(cor_drink_gender)
str(HSE_2011)
alcohol_percent <- HSE_2011 %>%
group_by(dnnow) %>%
summarise(Percentage = n() / nrow(HSE_2011) * 100)
alcohol_percent
table(HSE_2011$dnnow)
table(HSE_2011$Sex)
table(HSE_2011$marstatc)
label_attribute(HSE_2011$marstatc)
table(HSE_2011$marstatc)
label_value(HSE_2011$marstatc)
table(HSE_2011$marstatc)
val_labels(HSE_2011$marstatc)
table(HSE_2011$marstatc)
library(psych)
library(tidyverse)
descriptives <- HSE_2011 %>% select(HHSize,bmival,Age) %>%   psych::describe(quant=c(.25,.75)) %>%
as_tibble(rownames="rowname")  %>%
print()
# We use Chi-square test since both sex and dnnow are categorical variables
response <- c('Yes','No')
male_counts <- c(3172, 605)
female_counts <- c(3540,1217)
#Creating a merged table
drink_status <- rbind(male_counts,female_counts)
#Performing a chi-square test
chisq.test(drink_status)
# We use Chi-square test since both sex and dnnow are categorical variables
response <- c('Yes','No')
white <- c(5925,1219)
w_irish <- c(62,15)
w_traveller <- c(2,1)
w_bg <- c(326,88)
w_caribean <- c(23,3)
w_ba <- c(8,2)
w_asian <- c(17,13)
mixed_bg <- c(18,13)
indian <- c(100,105)
pakistani <- c(6,134)
bangladesh <- c(5,41)
chinese <- c(26,8)
asian_bg <- c(52,45)
african <- c(46,72)
caribean <- c(53,25)
black_bg <- c(18,4)
arab <- c(4,7)
other <- c(11,15)
#Creating a merged table
region_drink_status <- rbind(white,w_irish,w_traveller,w_bg,w_caribean,w_ba,w_asian,mixed_bg,indian,pakistani,bangladesh,chinese,asian_bg,african,caribean,black_bg,arab,other)
#Performing a chi-square test
chisq.test(region_drink_status, simulate.p.value=TRUE)
wilcox_test_result <- wilcox.test(htval ~ Sex, data = height_weight)
wilcox_test_result
wilcox_test_result <- wilcox.test(wtval ~ Sex, data = height_weight)
wilcox_test_result
cor_age_income = cor.test(HSE_2011$Age, HSE_2011$eqvinc, method = "spearman",exact = FALSE)
print(cor_age_income)
cor_drink_income = cor.test(HSE_2011$dnnow, HSE_2011$eqvinc)
print(cor_drink_income)
cor_drink_age = cor.test(HSE_2011$dnnow, HSE_2011$Age)
print(cor_drink_age)
cor_drink_gender = cor.test(HSE_2011$dnnow, HSE_2011$Sex)
print(cor_drink_gender)
print(cor_income_gender)
cor_income_gender = cor.test(HSE_2011$eqvinc, HSE_2011$Sex)
print(cor_income_gender)
cor_age_drink = cor.test(HSE_2011$Age, HSE_2011$dnnow)
print(cor_age_drink)
cor_age_gender = cor.test(HSE_2011$Age, HSE_2011$Sex)
print(cor_age_gender)
table(HSE_2011$dnnow)
alcohol_percent <- HSE_2011 %>%
group_by(dnnow) %>%
summarise(Percentage = n() / nrow(HSE_2011) * 100)
alcohol_percent
dim(HSE_2011)
alcohol_percent <- HSE_2011 %>%
group_by(dnnow) %>%
summarise(Percentage = n() / nrow(HSE_2011) * 100)
alcohol_percent
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
crime_data <- read_sav("csew1314teachingopen.sav")
boxplot(crime_data$antisocx)
summary((crime_data$antisocx))
ggplot(data = crime_data,mapping= aes(x=antisocx,fill = antisocx)) + geom_boxplot(outlier.colour = "red", outlier.shape = 16) + ggtitle("Levels of anti-social behaviour in neighbourhood ‘antisocx") +
xlab("antisocx") +
ylab("Y-axis Label") +
theme_minimal()
bxplot
ggplot(data = crime_data,mapping= aes(x=bcsvictim, fill=bcsvictim)) + geom_bar(color = "green") + ggtitle("whether or not the survey respondents experienced crime in the 12 months prior to the survey") +
xlab("bcsvictim") +
ylab("Y-axis Label") +
theme_minimal() +
scale_fill_manual(values = c("white", "orange"))  # Set the bar color to orange
x<- c(2,45,78,23,14,56,89,23,45,56,78,3,4)
y<- c(17,45,78,23,40,56,89,23,45,56,78,50,90)
cor(x,y, method="pearson")
hist(x)
hist(y)
qqnorm(x)
qqline(x)
setwd("D:/SCHULE/NUMERICAL Analysis/UNIT 1")
library(foreign)
#Importing spss data
crimedata <- read_sav("csew1314teachingopen.sav")
names(crimedata)
summary(crimedata$antisocx)
hist(crimedata$antisocx)
hist(crimedata$antisocx)
# Median = -0.185 and Mean = -0.007
# mean > median indicating right skewness in the data as seen with the histogram
#Therefore the median is more appropriate to define the data
summary(crimedata$bcsvictim)
table(crimedata$bcsvictim, useNA = 'always')
as_factor(crimedata$bcsvictim, c("Yes", "No"))
table(crimedata$bcsvictim, useNA = 'always')
summary(crimedata$antisocx)
library(readr)
library(readr)
setwd("D:/SCHULE/NUMERICAL Analysis/R activities")
web_page_data <- read_csv("D:/SCHULE/NUMERICAL Analysis/R activities/web_page_data.csv")
head(web_page_data)
t.test(Time ~ Page, data=web_page_data, alternative='less')
# Median = -0.185 and Mean = -0.007
# mean > median indicating right skewness in the data as seen with the histogram
#Therefore the median is more appropriate to define the data
summary(crimedata$bcsvictim)
summary(crimedata$antisocx)
library(haven)
library(dplyr)
Health_Data <- read_sav("D:/SCHULE/NUMERICAL Analysis/R activities/Health Data.sav")
data <- Health_Data %>% select('sbp','dbp','income')
summary(data)
summary(data$income)
fivenum(data$income)
library(dplyr)
library(ggplot2)
crime_data <- read_sav("csew1314teachingopen.sav")
boxplot(crime_data$antisocx)
summary((crime_data$antisocx))
ggplot(data = crime_data,mapping= aes(x=antisocx,fill = antisocx)) + geom_boxplot(outlier.colour = "red", outlier.shape = 16) + ggtitle("Levels of anti-social behaviour in neighbourhood ‘antisocx") +
xlab("antisocx") +
ylab("Y-axis Label") +
theme_minimal()
bxplot
library(dplyr)
library(ggplot2)
crime_data <- read_sav("csew1314teachingopen.sav")
boxplot(crime_data$antisocx)
summary((crime_data$antisocx))
ggplot(data = crime_data,mapping= aes(x=antisocx,fill = antisocx)) + geom_boxplot(outlier.colour = "red", outlier.shape = 16) + ggtitle("Levels of anti-social behaviour in neighbourhood ‘antisocx") +
xlab("antisocx") +
ylab("Y-axis Label") +
theme_minimal()
library(dplyr)
library(ggplot2)
crime_data <- read_sav("csew1314teachingopen.sav")
boxplot(crime_data$antisocx)
#summary((crime_data$antisocx))
#ggplot(data = crime_data,mapping= aes(x=antisocx,fill = antisocx)) + geom_boxplot(outlier.colour = "red", outlier.shape = 16) + ggtitle("Levels of anti-social behaviour in neighbourhood ‘antisocx") +
#xlab("antisocx") +
#ylab("Y-axis Label") +
#theme_minimal()
library(dplyr)
library(ggplot2)
crime_data <- read_sav("csew1314teachingopen.sav")
boxplot(crime_data$antisocx)
#summary((crime_data$antisocx))
ggplot(data = crime_data,mapping= aes(x=antisocx,fill = antisocx)) + geom_boxplot(outlier.colour = "red", outlier.shape = 16) + ggtitle("Levels of anti-social behaviour in neighbourhood ‘antisocx") +
xlab("antisocx") +
ylab("Y-axis Label") +
theme_minimal()
ggplot(data = crime_data,mapping= aes(x=bcsvictim, fill=bcsvictim)) + geom_bar(color = "green") + ggtitle("whether or not the survey respondents experienced crime in the 12 months prior to the survey") +
xlab("bcsvictim") +
ylab("Y-axis Label") +
theme_minimal() +
scale_fill_manual(values = c("white", "orange"))  # Set the bar color to orange
#checking for normal distribution of sbp
hist(Health_Data$sbp,
col="green",
border="black",
prob = TRUE,
xlab = "temp",
main = "GFG")
summary(data)
summary(data$income)
fivenum(data$income)
boxplot(data$income)
library(ggplot2)
data %>% ggplot(mapping=aes(income)) + geom_boxplot()
#Run a suitable hypothesis test to see if there is any association between systolic blood pressure and presence and absence of peptic ulcer.
data <- Health_Data %>% select(pepticulcer,sbp)
View(data)
#Check number of levels in peptiulcer
table(data$pepticulcer)
#checking for normal distribution of sbp
hist(Health_Data$sbp,
col="green",
border="black",
prob = TRUE,
xlab = "temp",
main = "GFG")
lines(density(Health_Data$sbp),
lwd = 2,
col = "chocolate3")
# QQplot of normally distributed values
qqnorm(Health_Data$sbp)
# Add qqline to plot
qqline(Health_Data$sbp, col = "darkgreen")
shapiro.test(Health_Data$sbp)
t_test_result <- t.test(sbp ~ pepticulcer, data = Health_Data)
# or
wilcox_test_result <- wilcox.test(sbp ~ pepticulcer, data = Health_Data)
t_test_result
wilcox_test_result
Health_Data <- read_sav("D:/SCHULE/NUMERICAL Analysis/R activities/Health Data.sav")
age = Health_Data$age
mean(age)
# custom r function to find mode
get_mode <- function(x){
return(sort(-table(x))[1])
}
get_mode(age)
median(age)
#checking for normal distribution of sbp
hist(Health_Data$sbp,
col="green",
border="black",
prob = TRUE,
xlab = "temp",
main = "GFG")
lines(density(Health_Data$sbp),
lwd = 2,
col = "chocolate3")
# QQplot of normally distributed values
qqnorm(Health_Data$sbp)
# Add qqline to plot
qqline(Health_Data$sbp, col = "darkgreen")
shapiro.test(Health_Data$sbp)
names(Health_Data)
wilcox.test(sbp~diabetes,Health_Data)
# check number of levels in occupation
table(Health_Data$occupation)
kruskal.test(sbp~occupation, data = Health_Data)
#With a p-value of 0.8545, we fail to reject the null hypothesis.
kruskal.test(sbp~occupation, data = Health_Data)
#1. Create a crosstab to assess how individuals' experience of any crime in the previous 12 months bcsvictim vary by age group agegrp7.
library(foreign)
#Importing spss data
crimedata <- read_sav("csew1314teachingopen.sav")
table(crimedata$bcsvictim, crimedata$agegrp7)
xtabs(~ crimedata$bcsvictim + crimedata$agegrp7, data = crimedata)
# Create a cross-tabulation with row percentages
cross_table <- prop.table(table(crimedata$bcsvictim, crimedata$agegrp7), margin = 1) * 100
# Round row percentages to two decimal places
cross_table <- round(cross_table, 2)
# Display the cross-tabulation with row percentages
print(cross_table)
# Create a contingency table
contingency_table <- table(crimedata$bcsvictim, crimedata$agegrp7)
# Perform chi-square test
chi_square_result <- chisq.test(contingency_table)
# Display the chi-square test results
print(chi_square_result)
# the p-value produced is 2.2e-16 which is less than .05, there we reject the null hypothesis and say that there is an association between crime and age group.
#Data Activity 8
#Using the Health_Data, please perform the following functions in R:
#Find out correlation between systolic and diastolic BP.
library(dplyr)
library(ggplot2)
library(readr)
library(nortest)
setwd("D:/SCHULE/NUMERICAL Analysis/R activities")
data <- read_csv("D:/SCHULE/NUMERICAL Analysis/R activities/Health_Data.csv")
ad.test(data$sbp)
ad.test(data$dbp)
# Calculate Spearman correlation
spearman_corr <- cor(data$sbp, data$dbp, method = "spearman")
# Print the result
print(spearman_corr)
result = cor.test(data$sbp, data$dbp, method = "spearman",exact = FALSE)
result
#Produce a scatter plot between systolic and diastolic BP.
plot(data$sbp,data$dbp)
# Calculate Spearman correlation
spearman_corr <- cor(data$sbp, data$dbp, method = "spearman")
# Print the result
print(spearman_corr)
result = cor.test(data$sbp, data$dbp, method = "spearman",exact = FALSE)
result
#Produce a scatter plot between systolic and diastolic BP.
plot(data$sbp,data$dbp)
setwd("D:/SCHULE/NUMERICAL Analysis/R activities")
data <- read_csv("D:/SCHULE/NUMERICAL Analysis/R activities/Health_Data.csv")
ad.test(data$sbp)
ad.test(data$dbp)
library(nortest)
setwd("D:/SCHULE/NUMERICAL Analysis/R activities")
data <- read_csv("D:/SCHULE/NUMERICAL Analysis/R activities/Health_Data.csv")
#Produce a scatter plot between systolic and diastolic BP.
plot(data$sbp,data$dbp)
model <- lm(dbp ~ sbp, data=data)
model
#2 . Interpret the findings of regression analysis at 5% level of significance.
summary(model)
#2 . Interpret the findings of regression analysis at 5% level of significance.
summary(model)
setwd("D:/SCHULE/NUMERICAL Analysis/R activities")
library(foreign)
library(haven)
#Importing spss data
crime_data <- read_sav("csew1314teachingopen.sav")
names(crime_data)
